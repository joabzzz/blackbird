/* Minimal port of Mostra UI tokens and components used here */

:root {
    --color-bg-primary: #000;
    --color-bg-overlay: rgba(0,0,0,0.9);
    --color-text-primary: #fff;
    --color-text-secondary: #fff;
    --color-text-muted: #cfcfcf;
    --color-accent-primary: #ff3509;
    --color-border: #ffffff;

    --font-family-primary: 'Inter', 'Helvetica Neue', Helvetica, Arial, ui-sans-serif, system-ui, sans-serif;
    --font-family-display: 'Helvetica Bold', 'Helvetica', 'Arial Black', sans-serif;

    --spacing-xs: 0.25rem;
    --spacing-sm: 0.5rem;
    --spacing-md: 1rem;
    --spacing-lg: 1.5rem;
    --spacing-xl: 2rem;
    --spacing-2xl: 3rem;

    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    --radius-2xl: 20px;
    --radius-full: 9999px;

    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.25);
}

* { box-sizing: border-box; }
body {
    background: var(--color-bg-primary);
    color: var(--color-text-primary);
    font-family: var(--font-family-primary);
    margin: 0;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}
html, body { height: 100%; }

/* Header */
.header { position: sticky; top: 0; z-index: 50; background: #000; border-bottom: 1px solid var(--color-border); backdrop-filter: blur(10px); padding-top: env(safe-area-inset-top); }
.header.no-divider { border-bottom: none; }
.header-content { max-width: 56rem; margin: 0 auto; padding: var(--spacing-lg) var(--spacing-md); display: flex; align-items: center; justify-content: space-between; }
.page-title { font-family: var(--font-family-display); font-weight: bold; margin: 0; letter-spacing: -0.02em; }

/* Layout */
.main-container { max-width: 56rem; margin: 0 auto; padding: var(--spacing-xl) var(--spacing-md); }
@media (max-width: 640px) {
    .main-container { padding-top: var(--spacing-md); }
    .chat-wrap { gap: var(--spacing-lg); }
}

/* Buttons */
.btn { background: transparent; border: 1px solid var(--color-border); color: var(--color-text-primary); border-radius: var(--radius-lg); padding: 0.6rem 1rem; font-weight: 600; cursor: pointer; transition: all .2s ease; }
.btn:hover { background: #111; }
.btn-ghost { border-color: transparent; color: var(--color-text-secondary); }
.btn-ghost:hover { background: #111; border-color: var(--color-border); }
.btn-primary { border-color: var(--color-accent-primary); color: var(--color-accent-primary); }
.btn-primary:hover { background: var(--color-accent-primary); color: #000; }

/* Stacks */
.hstack { display: flex; flex-direction: row; align-items: center; }
.vstack { display: flex; flex-direction: column; align-items: stretch; }

/* Chat */
.chat-wrap { display: flex; flex-direction: column; gap: var(--spacing-xl); }
.chat-list { display: flex; flex-direction: column; gap: var(--spacing-md); scroll-behavior: smooth; overflow-y: auto; -webkit-overflow-scrolling: touch; justify-content: flex-end; padding: 0 16px; padding-bottom: calc(96px + env(safe-area-inset-bottom)); }

/* Ensure layout fills viewport and keeps messages anchored to bottom */
.main-container { display: flex; flex-direction: column; min-height: 100vh; min-height: 100dvh; }
.chat-wrap { flex: 1; min-height: 0; }
.message-row { display: flex; gap: var(--spacing-md); align-items: flex-start; }
.message-row.user { justify-content: flex-end; }
.message-row.assistant { justify-content: flex-start; }
.avatar { width: 40px; height: 40px; border-radius: var(--radius-full); display: grid; place-items: center; font-weight: 700; }
.avatar.user { border: 1px solid var(--color-border); color: var(--color-text-primary); }
.avatar.assistant { display: none; }
.bubble { position: relative; max-width: 80%; padding: 0.85rem 1rem; border: 1px solid var(--color-border); font-size: 0.9rem; line-height: 1.6; border-radius: var(--radius-2xl); box-shadow: var(--shadow-sm); white-space: pre-wrap; }
.bubble.assistant { max-width: 95%; }
/* Swap fills per spec: user light, Blackbird dark with white border */
.bubble.user { background: #fff; color: #000; border-radius: var(--radius-2xl) var(--radius-2xl) var(--radius-sm) var(--radius-2xl); }
.bubble.assistant { background: #000; color: #fff; border-color: #fff; border-radius: var(--radius-2xl) var(--radius-sm) var(--radius-2xl) var(--radius-2xl); max-width: 98%; }
/* Higher-specificity to avoid overrides */
.message-row.user .bubble { background: #fff; color: #000; border-color: var(--color-border); }
.message-row.assistant .bubble { background: #000; color: #fff; border-color: #fff; }

/* Reserve space for top-right controls in assistant bubbles */
.message-row.assistant .bubble { padding-top: 1.9rem; }

/* Markdown rendering inside bubbles: remove extra spacing */
.bubble .md { white-space: normal; }
.bubble .md p { margin: 0 0 0.75rem 0; }
.bubble .md p:last-child { margin-bottom: 0; }
.bubble .md ul, .bubble .md ol { margin: 0 0 0.75rem 1.25rem; }
.bubble .md pre { margin: 0.5rem 0; padding: 0.75rem; background: #0f0f0f; color: #f4f4f4; border-radius: var(--radius-xl); overflow-x: auto; }
.bubble .md code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 0.92em; }
.message-row.user .bubble .md pre { background: #f5f5f5; color: #111; }

/* Copy button */
.copy-btn { position: absolute; top: 6px; right: 8px; appearance: none; border: none; background: transparent; color: inherit; opacity: 0.6; cursor: pointer; padding: 2px; line-height: 1; font-size: 0.9rem; }
.copy-btn:hover { opacity: 1; }

/* Bubble controls (copy + processed time) */
.bubble-controls { position: absolute; top: 8px; right: 10px; display: inline-flex; align-items: center; gap: 12px; color: var(--color-text-muted); font-size: 0.8rem; opacity: 0.9; }
.bubble-controls .processed-time { white-space: nowrap; }
.bubble-controls .copy-btn { position: static; opacity: 0.85; }
.bubble-controls .action-btn { position: static; opacity: 0.85; }
.bubble.assistant .bubble-controls { color: #bdbdbd; }
.bubble.user .bubble-controls { color: #333; }

/* Typing indicator */
.typing { display: inline-flex; gap: 4px; align-items: center; }
.typing .dot { width: 6px; height: 6px; border-radius: var(--radius-full); background: #000; animation: bounce 1s infinite ease-in-out; }
.typing .dot:nth-child(1){ animation-delay: -0.2s; }
.typing .dot:nth-child(2){ animation-delay: -0.1s; }

@keyframes bounce { 0%, 80%, 100% { transform: translateY(0); opacity: .5 } 40% { transform: translateY(-4px); opacity: 1 } }

/* Pending bubble (no border/background while waiting) */
.bubble.pending { border-color: transparent !important; background: transparent !important; box-shadow: none !important; }
.bubble.pending .md { color: #9b9b9b; }

/* Shimmer text for processing indicator */
.shimmer-text {
    position: relative;
    display: inline-block;
    color: #9b9b9b; /* gray base */
    background: linear-gradient(90deg, #9b9b9b 0%, #ffffff 40%, #9b9b9b 80%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    background-size: 200% 100%;
    animation: shimmer 1.6s linear infinite;
}
@keyframes shimmer {
    0% { background-position: -100% 0; }
    100% { background-position: 100% 0; }
}

/* Composer */
.composer { position: sticky; bottom: 0; background: var(--color-bg-overlay); border-top: 1px solid var(--color-border); }
.composer.no-divider { border-top: none; }
.composer-inner { max-width: 56rem; margin: 0 auto; padding: var(--spacing-md); padding-bottom: calc(var(--spacing-md) + env(safe-area-inset-bottom)); display: flex; gap: var(--spacing-md); align-items: flex-end; }
.composer textarea { flex: 1; background: #000; color: #fff; border: 1px solid #2a2a2a; border-radius: var(--radius-xl); padding: 0.8rem 1rem; resize: vertical; min-height: 44px; max-height: 160px; outline: none; }
.composer textarea:focus { border-color: var(--color-border); }

/* Subtle text buttons for actions */
.action-btn {
    appearance: none;
    border: none;
    background: transparent;
    color: #9b9b9b;
    font-size: 0.78rem;
    padding: 0;
    cursor: pointer;
}
.action-btn:hover { color: #cfcfcf; text-decoration: underline; }

/* Tabs in header */
.tabs { display: inline-flex; gap: 18px; align-items: baseline; }
.tab { appearance: none; border: none; background: transparent; color: #7d7d7d; padding: 0; border-radius: 0; font-family: var(--font-family-display); font-size: 1.75rem; font-weight: 800; letter-spacing: -0.02em; cursor: pointer; }
.tab:hover { color: #bdbdbd; }
.tab.active { color: #ffffff; }
